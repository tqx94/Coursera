---
title: "machine learning course project"
author: "Farren"
date: "05/09/2018"
output: html_document
---

The goal of this project is to predict how well people exercise. 
```{r, Loading of packages, echo =FALSE, message=FALSE}
library(ggplot2)
library(caret)
library(data.table)
library(dplyr)
```

```{r, Loading of data, echo =FALSE, message=FALSE}
testing <- fread("~/Documents/Coursera/MachineLearning/pml_testing.csv")
training <- fread("~/Documents/Coursera/MachineLearning/pml_training.csv")
```

Preprocessing the data
1. removing the unneccessary variable V1
2. changing the "" to NA, and converting the data to numeric where possible
3. Removing username and date since not useful
```{r, preprocessing the data}
#training
training <- training %>% select(-V1)
training[training ==""] <- NA
training[training =="#DIV/0!"] <- NA
training <- data.frame(training)
training[,c(6:158)] <- data.frame(apply(training[c(6:158)], 2, as.numeric))
training$new_window <- as.factor(training$new_window)
training$classe <- as.factor(training$classe)
training <- training %>% select(-user_name,-cvtd_timestamp)
#testing
testing <- testing %>% select(-V1)
testing[testing ==""] <- NA
testing[testing =="#DIV/0!"] <- NA
testing <- data.frame(testing)
testing[,c(6:158)] <- data.frame(apply(testing[c(6:158)], 2, as.numeric))
testing$new_window <- as.factor(testing$new_window)
```

Creating a validation set from the training set
```{r, creating validation set}
set.seed(12345)
val_ind <- createDataPartition(y=training$classe, p =0.7, list =FALSE)
validation <- training[-val_ind,]
training <- training[val_ind,]
```


Feature selection
1. Looking at the percentage of NAs. Remove columns where % of NAs >90%
2. Creating dummy variable for the factor var(window)
3. Want to remove highly skewed variable (boxplot/ gaussian)
```{r, variable selection}
#% of NAs, and choose the same var for testing set
training <- training %>% select(which(colMeans(is.na(.)) < 0.9))

# checking for highly correlated var
dummies <- dummyVars(classe~new_window,data=training)
dummyvar <- as.data.frame(predict(dummies,newdata = training))
training <- cbind(training, dummyvar)
training <- training %>% select(-new_window)

#removing highly skewed variable

```